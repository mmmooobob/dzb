(function(a){var b=function(f,d){var e=this;e.div=typeof(f)=="string"?document.getElementById(f):f;e.options={urls:"",interval:3000,track:"left",speed:10,time:500,lpos:0,posInit:null,posSet:null,ulImg:null,ulBtn:null,pos:1,x:0,firstx:0,move:true,direction:"",touchmove:false,kernel:"",width:$(e.div).width(),aotuTime:null,};var c;for(c in d){e.options[c]=d[c]}e.options.urls=e.options.urls.split(",");if(e.options.lpos==0){e.options.lpos=e.options.urls.length}e.setBroseType();e._initHtml();e._initCssAndEvent();if(e.options.lpos>1){e._auto();e._watchAuto()}return e};b.prototype={handleEvent:function(d){var c=this;switch(d.type){case"touchstart":c._touchstart(d);break;case"touchmove":c._touchmove(d);break;case"touchend":c._touchend(d);break}},_touchstart:function(d){var c=this;c.options.touchmove=true;c.options.firstx=a.event.touches[0].pageX;if(c.options.aotuTime){clearInterval(c.options.aotuTime);c.options.aotuTime=null}},_touchmove:function(g){var f=this;if(!f.options.touchmove){return}f.options.touchmove=false;var d=a.event.touches[0].pageX;var c=d-f.options.firstx;if(Math.abs(c)>15){g.preventDefault();if(c>0){f.options.direction="right"}else{f.options.direction="left"}}else{f.options.direction=null;f.options.firstx=d}},_touchend:function(d){var c=this;if(c.options.touchmove){c._wxScale(d);return}c.options.touchmove=true;if(c.options.direction=="right"){c._right()}else{if(c.options.direction=="left"){c._left()}}},_wxScale:function(h){var d=this;var f=a.document.domain,c,g=[];for(c=0;c<d.options.lpos;c++){g[c]="http://"+f+d.options.urls[c]}var j="http://"+$(h.currentTarget).find("img").attr("src");if(RegExp("MicroMessenger").test(navigator.userAgent)&&typeof(d.options.urls)=="object"){WeixinJSBridge.invoke("imagePreview",{current:j,urls:g})}},_right:function(){var e=this;if(!e.options.move){return}e.options.move=false;e.options.pos--;var d=-e.options.width*(e.options.pos);var c=d-e.options.x;if(e.options.pos==0){e._transform(c,e.options.time,e.options.speed,0,function(f){f.options.pos=f.options.lpos;f.options.x=-(f.options.width*f.options.lpos);e._setPos()})}else{e._transform(c,e.options.time,e.options.speed,0);e._setPos()}},_left:function(){var e=this;if(!e.options.move){return}e.options.move=false;e.options.pos++;var d=-e.options.width*(e.options.pos);var c=d-e.options.x;if(e.options.pos-1==e.options.lpos){e._transform(c,e.options.time,e.options.speed,0,function(f){f.options.pos=1;f.options.x=-f.options.width;e._setPos()})}else{e._transform(c,e.options.time,e.options.speed,0);e._setPos()}},_auto:function(){var c=this;c.options.aotuTime=setInterval(function(){if(c.options.track=="left"){c._left()}else{track._right()}},c.options.interval)},_watchAuto:function(){var c=this;setInterval(function(){if(!c.options.aotuTime){c._auto()}},5000)},_transform:function(c,f,e,h,g){var d=this;if(typeof(f)!="undefined"&&typeof(e)!="undefined"&&f>0&&e>0){h++;if(h>parseInt(f/e)){if(typeof(g)=="function"){g.call(this,d)}d.options.move=true;return}d.options.x+=c*(e/f);d._pos();setTimeout(function(){d._transform(c,f,e,h,g)},e)}else{d.options.x+=c;d._pos();d.options.move=true}},_pos:function(){var c=this;c.options.kernel?c.options.ulImg.css("-"+c.options.kernel+"-transform","translate("+c.options.x+"px, 0px)"):c.options.ulImg.css("transform","translate("+c.options.x+"px, 0px)")},_initHtml:function(){var f=this;var e,d=f.options.urls.length,c;if(!f.options.ulImg){f.options.ulImg=$("<ul></ul>");for(e=0;e<f.options.lpos;e++){c=$('<li><img src="'+f.options.urls[e]+'" style="width:100%;height:100%;"/></li>');f.options.ulImg.append(c)}$(f.div).append(f.options.ulImg)}if(!f.options.ulBtn&&f.options.lpos>1){f.options.ulBtn=$("<ul></ul>");f.options.ulBtn.css({position:"absolute",bottom:"16px",right:"20px",margin:"0",padding:"0","list-style":"none",});for(e=0;e<f.options.lpos;e++){f.options.ulBtn.append("<li><a>"+e+"</a></li>")}f.options.ulBtn.find("li").css({"float":"left","margin-left":"6px",padding:"0",});f.options.ulBtn.find("li").find("a").css({width:"10px",height:"10px","border-radius":"30px","box-shadow":"inset 0 0 3px rgab(0,0,0,0.3)",background:"rgba(0,0,0,0.5)",display:"block","text-indent":"-9999px"});$(f.div).css({position:"relative",left:"0",right:"0",});$(f.div).append(f.options.ulBtn);if(typeof(f.options.posInit)=="function"){f.options.posInit.call(this,f)}}},_initCssAndEvent:function(){var e=this,c=0;if(e.options.lpos>1){var f=e.options.ulImg.find("li").eq(e.options.lpos-1).clone(),d=e.options.ulImg.find("li").eq(0).clone();e.options.ulImg.find("li").eq(0).before(f);e.options.ulImg.append(d);e._bind("touchstart",e.options.ulImg[0],false);e._bind("touchmove",e.options.ulImg[0],false);e._bind("touchend",e.options.ulImg[0],false);e._transform(-e.options.width);c=2;e._setPos()}e.options.ulImg.wrap('<div style="width:'+e.options.width+'px;height:100%;overflow:hidden;"></div>');e.options.ulImg.css({width:e.options.width*(e.options.lpos+c)+"px",height:"100%",overflow:"hidden",margin:0,padding:"0","list-style":"none",});e.options.ulImg.find("li").css({"float":"left",width:e.options.width+"px",height:"100%",overflow:"hidden",padding:"0",})},_setPos:function(){var c=this;if(typeof(c.options.posSet)=="function"){c.options.posSet.call(this,c)}else{c.options.ulBtn.find("li").find("a").css("background","rgba(0,0,0,0.5)");c.options.ulBtn.find("li").eq(c.options.pos-1).find("a").css("background","rgba(0,0,0,0.9)")}},setBroseType:function(){var f=this;dummyStyle=document.body.style;var g="t,webkitT,MozT,msT,OT".split(","),e,d=0,c=g.length;for(;d<c;d++){e=g[d]+"ransform";if(e in dummyStyle){f.options.kernel=g[d].substr(0,g[d].length-1);break}}},_bind:function(e,d,c){d.addEventListener(e,this,!!c)},_unbind:function(e,d,c){d.removeEventListener(e,this,!!c)},};a.slidepic=b})(window);